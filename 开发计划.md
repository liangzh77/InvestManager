# æŠ•èµ„ç®¡ç†ç³»ç»Ÿ - å¼€å‘è®¡åˆ’

## æ ¸å¿ƒè®¾è®¡åŸåˆ™

* **ä¸ªäººä½¿ç”¨**ï¼šå•ç”¨æˆ·æ— éœ€èº«ä»½è®¤è¯
* **è½»é‡çº§**ï¼šæœ€å°ä¾èµ–ï¼Œå¿«é€Ÿå¯åŠ¨
* **Verceléƒ¨ç½²**ï¼šå……åˆ†åˆ©ç”¨serverlessç‰¹æ€§
* **æ˜“å¼€å‘ç»´æŠ¤**ï¼šä»£ç ç»“æ„ç®€å•æ¸…æ™°
* **å­¦ä¹ æˆæœ¬ä½**ï¼šé‡‡ç”¨ä¸»æµæŠ€æœ¯æ ˆ

## æŠ€æœ¯æ¶æ„è°ƒæ•´

### æ•°æ®åº“æ–¹æ¡ˆï¼šSQLite + Better-SQLite3

```
ä¼˜åŠ¿ï¼š
âœ… æ–‡ä»¶æ•°æ®åº“ï¼Œé›¶é…ç½®
âœ… Better-SQLite3 åŒæ­¥æ“ä½œï¼Œä»£ç ç®€å•
âœ… Vercel Edge Runtime æ”¯æŒ
âœ… ä¸ªäººä½¿ç”¨æ€§èƒ½å……è¶³
âœ… æ•°æ®æ–‡ä»¶å¯ç›´æ¥å¤‡ä»½

æ³¨æ„äº‹é¡¹ï¼š
âš ï¸ Vercel æ— çŠ¶æ€ç¯å¢ƒï¼Œéœ€è€ƒè™‘æ•°æ®æŒä¹…åŒ–
ğŸ’¡ å»ºè®®ï¼šä½¿ç”¨ Vercel KV æˆ–å®šæœŸå¤‡ä»½åˆ°GitHub
```

### æŠ€æœ¯æ ˆ

* **å‰ç«¯**: Next.js 14 (App Router)
* **æ•°æ®åº“**: SQLite + Better-SQLite3
* **UI**: TailwindCSS + shadcn/ui
* **å›¾è¡¨**: Recharts
* **éƒ¨ç½²**: Vercel

## æ•°æ®ç»“æ„

```sql
-- é¡¹ç›®è¡¨
CREATE TABLE projects (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  é¡¹ç›®åç§° TEXT NOT NULL,
  é¡¹ç›®ä»£å· TEXT,
  äº¤æ˜“ç±»å‹ TEXT CHECK(çŠ¶æ€ IN ('åšå¤š', 'åšç©º')),
  æˆæœ¬ä»· REAL,
  å½“å‰ä»· REAL,
  è‚¡æ•° INTEGER,
  ä»“ä½ REAL,
  æˆæœ¬é‡‘é¢ REAL,
  å½“å‰é‡‘é¢ REAL,
  ç›ˆäºé‡‘é¢ REAL,
  é¡¹ç›®ç›ˆäºç‡ REAL,
  æ€»ç›ˆäºç‡ REAL,
  çŠ¶æ€ TEXT CHECK(çŠ¶æ€ IN ('è¿›è¡Œ', 'å®Œæˆ')),
  åˆ›å»ºæ—¶é—´ DATETIME DEFAULT CURRENT_TIMESTAMP,
  å®Œæˆæ—¶é—´ DATETIME
);

-- äº¤æ˜“è¡¨
CREATE TABLE transactions (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  é¡¹ç›®ID INTEGER,
  é¡¹ç›®åç§° TEXT,
  çŠ¶æ€ TEXT CHECK(çŠ¶æ€ IN ('è®¡åˆ’', 'å®Œæˆ')),
  äº¤æ˜“åç§° TEXT,
  äº¤æ˜“ç±»å‹ TEXT CHECK(çŠ¶æ€ IN ('åšå¤š', 'åšç©º', 'å¤šå¤´å¹³ä»“', 'ç©ºå¤´å¹³ä»“')),
  è­¦å‘Šæ–¹å‘ TEXT CHECK(çŠ¶æ€ IN ('å‘ä¸Š', 'å‘ä¸‹')),
  è·ç¦» REAL,
  äº¤æ˜“ä»· REAL,
  è‚¡æ•° INTEGER,
  ä»“ä½ REAL,
  äº¤æ˜“é‡‘é¢ REAL,
  åˆ›å»ºæ—¶é—´ DATETIME DEFAULT CURRENT_TIMESTAMP,
  äº¤æ˜“æ—¶é—´ DATETIME,
  FOREIGN KEY (é¡¹ç›®ID) REFERENCES projects(id)
);

-- æ€»è§ˆè¡¨
CREATE TABLE overview (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  æ€»é‡‘é¢ REAL,
  æˆæœ¬é‡‘é¢ REAL,
  æŒä»“é‡‘é¢ REAL,
  ç›ˆäºé‡‘é¢ REAL,
  ç›ˆäºç‡ REAL,
  ä»“ä½ REAL,
  æ›´æ–°æ—¶é—´ DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## é¡¹ç›®ç»“æ„

```
/invest-manager
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ plans/
â”‚   â”‚   â”œâ”€â”€ projects/
â”‚   â”‚   â”œâ”€â”€ transactions/
â”‚   â”‚   â”œâ”€â”€ overview/
â”‚   â”‚   â””â”€â”€ test/            # æµ‹è¯•APIé¡µé¢
â”‚   â”œâ”€â”€ dashboard/           # æ€»è§ˆé¡µ
â”‚   â”œâ”€â”€ plans/              # è®¡åˆ’é¡µ
â”‚   â”œâ”€â”€ projects/           # é¡¹ç›®é¡µ
â”‚   â”œâ”€â”€ transactions/       # äº¤æ˜“é¡µ
â”‚   â”œâ”€â”€ funds/
â”‚   â””â”€â”€ statistics/         # ç»Ÿè®¡é¡µ
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ db.ts              # SQLite è¿æ¥å’Œåˆå§‹åŒ–
â”‚   â”œâ”€â”€ schema.sql         # æ•°æ®åº“Schema
â”‚   â”œâ”€â”€ calculations.ts    # è®¡ç®—é€»è¾‘
â”‚   â””â”€â”€ utils.ts           # å·¥å…·å‡½æ•°
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                # shadcn/ui ç»„ä»¶
â”‚   â”œâ”€â”€ charts/            # å›¾è¡¨ç»„ä»¶
â”‚   â”œâ”€â”€ forms/             # è¡¨å•ç»„ä»¶
â”‚   â”œâ”€â”€ plans/             # è®¡åˆ’é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ projects/          # é¡¹ç›®é¡µé¢ç»„ä»¶
â”‚   â””â”€â”€ editable/          # å¯ç¼–è¾‘ç»„ä»¶
â””â”€â”€ data/
    â””â”€â”€ investment.db      # SQLite æ•°æ®åº“æ–‡ä»¶
```

## é¡µé¢è®¾è®¡è§„èŒƒ

### è¦æ±‚
- æ‰€æœ‰é¡µçš„å·¦ä¸Šè§’ç›¸åŒä½ç½®éƒ½æœ‰ä¸€ä¸ªæŒ‰é’®â€œéšè—â€ï¼Œç‚¹å‡»å˜ä¸ºâ€œæ˜¾ç¤ºâ€ã€‚å¯éšè—æ•°å€¼ï¼ˆè‚¡æ•°ã€æˆæœ¬é‡‘é¢ã€ç›ˆäºé‡‘é¢ã€äº¤æ˜“é‡‘é¢ã€å½“å‰é‡‘é¢ï¼Œæ€»é‡‘é¢ã€æŒä»“é‡‘é¢ï¼‰ï¼Œå˜ä¸º****

### è®¡åˆ’é¡µ (/plans)

#### åŠŸèƒ½æè¿°
- æ˜¾ç¤ºæ‰€æœ‰çŠ¶æ€ä¸º"è¿›è¡Œ"çš„é¡¹ç›®çš„"è®¡åˆ’"çŠ¶æ€äº¤æ˜“
- ç›¸åŒé¡¹ç›®çš„äº¤æ˜“åˆ†ç»„æ˜¾ç¤ºï¼Œå…±äº«èƒŒæ™¯æ¡†
- æ”¯æŒè¡Œå†…ç¼–è¾‘ï¼Œå®æ—¶è®¡ç®—ç›¸å…³å­—æ®µ

#### å¸ƒå±€è®¾è®¡

| é¡¹ç›®åç§° | äº¤æ˜“åç§° | äº¤æ˜“ç±»å‹ | è­¦å‘Šæ–¹å‘ | è·ç¦» | å½“å‰ä»· | äº¤æ˜“ä»· | è‚¡æ•° | ä»“ä½ | äº¤æ˜“é‡‘é¢ | åˆ›å»ºæ—¶é—´ |
|-----|----------|---------|----------|------|--------|------|------|-----|--------|---------|
| æ³¡æ³¡ç›ç‰¹ | ç¬¬ä¸€æ‰‹   | åšå¤š     | å‘ä¸Š     | 20   | 1000 | 1200   | 80  | 120 | 120000 | 2025-09-17 |
| æ³¡æ³¡ç›ç‰¹ | æœ€åä¸€æ‰‹ | å¤šå¤´å¹³ä»“ | å‘ä¸Š     | 20   | 1000 | 1200   | 100  | 20  | 120000 | 2025-09-17 |
|  |  |  |  |  |  |  |  |  |  |
| å®‰å…‹åˆ›æ–° | ç¬¬ä¸€æ‰‹   | åšå¤š     | å‘ä¸Š     | 20   | 1100 | 1200   | 1000 | 120 | 120000 | 2025-09-17 |
| å®‰å…‹åˆ›æ–° | ç¬¬ä¸€æ‰‹   | å¤šå¤´å¹³ä»“ | å‘ä¸Š     | 20   | 1100 | 1200   | 60   | 10  | 120000 | 2025-09-17 |

#### å¯ç¼–è¾‘å­—æ®µåŠè®¡ç®—é€»è¾‘
- **äº¤æ˜“åç§°ã€äº¤æ˜“ç±»å‹ã€åˆ›å»ºæ—¶é—´**ï¼šç›´æ¥ç¼–è¾‘
- **è­¦å‘Šæ–¹å‘**ï¼šæ”¹å˜æ—¶è‡ªåŠ¨è®¡ç®—è·ç¦»
- **è·ç¦»**ï¼šæ”¹å˜æ—¶è‡ªåŠ¨è®¡ç®—äº¤æ˜“ä»·
- **å½“å‰ä»·**ï¼šæ”¹å˜æ—¶è‡ªåŠ¨è®¡ç®—è·ç¦»
- **äº¤æ˜“ä»·**ï¼šæ”¹å˜æ—¶è‡ªåŠ¨è®¡ç®—è·ç¦»ã€è‚¡æ•°
- **è‚¡æ•°**ï¼šæ”¹å˜æ—¶è‡ªåŠ¨è®¡ç®—ä»“ä½ã€äº¤æ˜“é‡‘é¢
- **ä»“ä½**ï¼šæ”¹å˜æ—¶è‡ªåŠ¨è®¡ç®—è‚¡æ•°ã€äº¤æ˜“é‡‘é¢
- **äº¤æ˜“é‡‘é¢**ï¼šæ”¹å˜æ—¶è‡ªåŠ¨è®¡ç®—è‚¡æ•°ã€ä»“ä½

### é¡¹ç›®é¡µ (/projects)

#### åŠŸèƒ½æè¿°
- æ˜¾ç¤ºæ‰€æœ‰é¡¹ç›®çš„è¯¦ç»†ä¿¡æ¯
- æ¯ä¸ªé¡¹ç›®æ˜¾ç¤ºå…¶å…³è”çš„æ‰€æœ‰äº¤æ˜“
- æ”¯æŒé¡¹ç›®å’Œäº¤æ˜“ä¿¡æ¯çš„è¡Œå†…ç¼–è¾‘

#### å¸ƒå±€è®¾è®¡

[é¡¹ç›®AèƒŒæ™¯æ¡†]

| é¡¹ç›®åç§°       | é¡¹ç›®ä»£å· | äº¤æ˜“ç±»å‹ | æˆæœ¬ä»·  | å½“å‰ä»· | è‚¡æ•° | ä»“ä½ | æˆæœ¬é‡‘é¢  | å½“å‰é‡‘é¢ | ç›ˆäºé‡‘é¢ | é¡¹ç›®ç›ˆäºç‡ | æ€»ç›ˆäºç‡ | çŠ¶æ€ |
|----------------|----------|----------|---------|--------|------|------|-----------|----------|----------|------------|--------------------|----------|
| æ³¡æ³¡ç›ç‰¹       | 9992     | åšå¤š     | -6100   | 1200   | 10   | 12   | -61000    | 12000    | 73000    | 0          | 73         | è¿›è¡Œ |

| çŠ¶æ€ | äº¤æ˜“åç§° | äº¤æ˜“ç±»å‹ | è­¦å‘Šæ–¹å‘ | è·ç¦» | äº¤æ˜“ä»· | è‚¡æ•° | ä»“ä½ | äº¤æ˜“é‡‘é¢ | åˆ›å»ºæ—¶é—´ |
|-----|----------|---------|----------|------|--------|------|-----|--------|---------|
| è¿›è¡Œ | ç¬¬ä¸€æ‰‹   | åšå¤š     | å‘ä¸Š     | 20   | 1200   | 80  | 120 | 120000 | 2025-09-17 |
| è¿›è¡Œ | æœ€åä¸€æ‰‹ | å¤šå¤´å¹³ä»“ | å‘ä¸Š     | 20   | 1200   | 100  | 20  | 120000 | 2025-09-17 |
|  |  |  |  |  |  |  |  |  |  |
| å®Œæˆ | ç¬¬ä¸€æ‰‹   | åšå¤š     | å‘ä¸Š     | 20   | 1200   | 1000 | 120 | 120000 | 2025-09-17 |
| å®Œæˆ | ç¬¬ä¸€æ‰‹   | å¤šå¤´å¹³ä»“ | å‘ä¸Š     | 20   | 1200   | 60   | 10  | 120000 | 2025-09-17 |

[é¡¹ç›®BèƒŒæ™¯æ¡†]
| é¡¹ç›®åç§°       | é¡¹ç›®ä»£å· | äº¤æ˜“ç±»å‹ | æˆæœ¬ä»·  | å½“å‰ä»· | è‚¡æ•° | ä»“ä½ | æˆæœ¬é‡‘é¢  | å½“å‰é‡‘é¢ | ç›ˆäºé‡‘é¢ | é¡¹ç›®ç›ˆäºç‡ | æ€»ç›ˆäºç‡ | çŠ¶æ€ |
|----------------|----------|----------|---------|--------|------|------|-----------|----------|----------|------------|--------------------|----------|
| å®‰å…‹åˆ›æ–°       | 992     | åšå¤š     | -6100   | 1200   | 10   | 12   | -61000    | 12000    | 73000    | 0          | 73         | å®Œæˆ |

| çŠ¶æ€ | äº¤æ˜“åç§° | äº¤æ˜“ç±»å‹ | è­¦å‘Šæ–¹å‘ | è·ç¦» | äº¤æ˜“ä»· | è‚¡æ•° | ä»“ä½ | äº¤æ˜“é‡‘é¢ | åˆ›å»ºæ—¶é—´ |
|-----|----------|---------|----------|------|--------|------|-----|--------|---------|
| å®Œæˆ | ç¬¬ä¸€æ‰‹   | åšå¤š     | å‘ä¸Š     | 20   | 1200   | 80  | 120 | 120000 | 2025-09-17 |
| å®Œæˆ | ç¬¬ä¸€æ‰‹   | å¤šå¤´å¹³ä»“ | å‘ä¸Š     | 20   | 1200   | 60   | 10  | 120000 | 2025-09-17 |



#### å¯ç¼–è¾‘é€»è¾‘
- é¡¹ç›®ä¿¡æ¯ï¼šé¡¹ç›®åç§°ã€é¡¹ç›®ä»£å·ã€å½“å‰ä»·å¯ç›´æ¥ç¼–è¾‘
- äº¤æ˜“ä¿¡æ¯ï¼šä½¿ç”¨ä¸è®¡åˆ’é¡µç›¸åŒçš„ç¼–è¾‘å’Œè®¡ç®—é€»è¾‘

### æ€»è§ˆé¡µ (/dashboard)

#### åŠŸèƒ½æè¿°
- æ˜¾ç¤ºæŠ•èµ„ç»„åˆçš„æ€»ä½“ç»Ÿè®¡ä¿¡æ¯
- æä¾›å…³é”®æŒ‡æ ‡çš„å¯è§†åŒ–å±•ç¤º

#### å¸ƒå±€è®¾è®¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æŠ•èµ„æ€»è§ˆ                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ€»é‡‘é¢     â”‚ æˆæœ¬é‡‘é¢   â”‚ æŒä»“é‡‘é¢   â”‚ ç›ˆäºé‡‘é¢   â”‚
â”‚  50,000   â”‚   48,000  â”‚   52,000  â”‚   4,000   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç›ˆäºç‡     â”‚ ä»“ä½      â”‚ æ›´æ–°æ—¶é—´              â”‚
â”‚   8.33%   â”‚   85%     â”‚ 2024-01-15 10:30    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[å›¾è¡¨åŒºåŸŸ]
- ç›ˆäºè¶‹åŠ¿å›¾
- ä»“ä½åˆ†å¸ƒå›¾
- é¡¹ç›®æ”¶ç›Šå¯¹æ¯”å›¾
```

### ç»Ÿè®¡é¡µ (/statistics)
**å¾…å¼€å‘** - é¢„ç•™ç»™æ›´é«˜çº§çš„åˆ†æåŠŸèƒ½

## æ•°æ®è®¡ç®—é€»è¾‘

### é¡¹ç›® (projects)

**å‰ç«¯è¾“å…¥å­—æ®µ**ï¼š
* é¡¹ç›®åç§°
* é¡¹ç›®ä»£å·
* äº¤æ˜“ç±»å‹ï¼ˆåšå¤š/åšç©ºï¼‰
* å½“å‰ä»·
* åˆ›å»ºæ—¶é—´
* å®Œæˆæ—¶é—´

**ç³»ç»Ÿè®¡ç®—å­—æ®µ**ï¼š
* **æˆæœ¬ä»·** = æˆæœ¬é‡‘é¢ Ã· è‚¡æ•° ï¼ˆè‚¡æ•° > 0 æ—¶ï¼‰
* **è‚¡æ•°** = âˆ‘(äº¤æ˜“è‚¡æ•°)
  * åšå¤šã€ç©ºå¤´å¹³ä»“ï¼šè‚¡æ•°åŠ 
  * åšç©ºã€å¤šå¤´å¹³ä»“ï¼šè‚¡æ•°å‡
* **ä»“ä½** = (å½“å‰é‡‘é¢ Ã· è‡ªä¸»æ€»é‡‘é¢) Ã— 100 ï¼ˆè‡ªä¸»æ€»é‡‘é¢ > 0 æ—¶ï¼‰
* **æˆæœ¬é‡‘é¢** = âˆ‘(äº¤æ˜“é‡‘é¢)
  * åšå¤šã€ç©ºå¤´å¹³ä»“ï¼šé‡‘é¢åŠ 
  * åšç©ºã€å¤šå¤´å¹³ä»“ï¼šé‡‘é¢å‡
* **å½“å‰é‡‘é¢** = è‚¡æ•° Ã— å½“å‰ä»·
* **ç›ˆäºé‡‘é¢** = å½“å‰é‡‘é¢ - æˆæœ¬é‡‘é¢
* **é¡¹ç›®ç›ˆäºç‡** = (ç›ˆäºé‡‘é¢ Ã· æˆæœ¬é‡‘é¢) Ã— 100 ï¼ˆæˆæœ¬é‡‘é¢ > 0 æ—¶ï¼‰
* **æ€»ç›ˆäºç‡** = (ç›ˆäºé‡‘é¢ Ã· æ€»é‡‘é¢) Ã— 100 ï¼ˆè‡ªä¸»æ€»é‡‘é¢ > 0 æ—¶ï¼‰

### äº¤æ˜“ (transactions)

**å‰ç«¯è¾“å…¥å­—æ®µ**ï¼š
* äº¤æ˜“åç§°
* çŠ¶æ€ï¼ˆè®¡åˆ’/å®Œæˆï¼‰
* äº¤æ˜“ç±»å‹
* è­¦å‘Šæ–¹å‘ï¼ˆå‘ä¸Š/å‘ä¸‹ï¼‰
* äº¤æ˜“ä»·
* è‚¡æ•°
* ä»“ä½
* äº¤æ˜“é‡‘é¢
* åˆ›å»ºæ—¶é—´
* äº¤æ˜“æ—¶é—´

**ç³»ç»Ÿè®¡ç®—å­—æ®µ**ï¼š
* **è·ç¦»**ï¼š
  * è‹¥æ–¹å‘ = å‘ä¸‹ï¼š - (äº¤æ˜“ä»· - é¡¹ç›®å½“å‰ä»·) Ã· é¡¹ç›®å½“å‰ä»· Ã— 100
  * è‹¥æ–¹å‘ = å‘ä¸Šï¼š   (äº¤æ˜“ä»· - é¡¹ç›®å½“å‰ä»·) Ã· é¡¹ç›®å½“å‰ä»· Ã— 100

### äº¤æ˜“é¡µé¢å®æ—¶è®¡ç®—é€»è¾‘

#### å½“ä¿®æ”¹è­¦å‘Šæ–¹å‘æ—¶ï¼š
```typescript
function updateDistanceOnDirectionChange(direction: 'å‘ä¸Š' | 'å‘ä¸‹', äº¤æ˜“ä»·: number, é¡¹ç›®å½“å‰ä»·: number) {
  if (direction === 'å‘ä¸‹') {
    return -((äº¤æ˜“ä»· - é¡¹ç›®å½“å‰ä»·) / é¡¹ç›®å½“å‰ä»·) * 100;
  } else {
    return ((äº¤æ˜“ä»· - é¡¹ç›®å½“å‰ä»·) / é¡¹ç›®å½“å‰ä»·) * 100;
  }
}
```

#### å½“ä¿®æ”¹è·ç¦»æ—¶ï¼š
```typescript
function updatePriceOnDistanceChange(è·ç¦»: number, é¡¹ç›®å½“å‰ä»·: number, è­¦å‘Šæ–¹å‘: string) {
  const distanceDecimal = è·ç¦» / 100;
  if (è­¦å‘Šæ–¹å‘ === 'å‘ä¸‹') {
    return é¡¹ç›®å½“å‰ä»· * (1 - Math.abs(distanceDecimal));
  } else {
    return é¡¹ç›®å½“å‰ä»· * (1 + distanceDecimal);
  }
}
```

#### å½“ä¿®æ”¹äº¤æ˜“ä»·æ—¶ï¼š
```typescript
function updateOnPriceChange(äº¤æ˜“ä»·: number, é¡¹ç›®å½“å‰ä»·: number, è­¦å‘Šæ–¹å‘: string) {
  // æ›´æ–°è·ç¦»
  const è·ç¦» = updateDistanceOnDirectionChange(è­¦å‘Šæ–¹å‘, äº¤æ˜“ä»·, é¡¹ç›®å½“å‰ä»·);
  // å¯ä»¥è¿›ä¸€æ­¥æ›´æ–°è‚¡æ•°ï¼ˆå¦‚æœéœ€è¦ä¿æŒäº¤æ˜“é‡‘é¢ä¸å˜ï¼‰
  return { è·ç¦» };
}
```

#### å½“ä¿®æ”¹è‚¡æ•°æ—¶ï¼š
```typescript
function updateOnSharesChange(è‚¡æ•°: number, äº¤æ˜“ä»·: number, æ€»é‡‘é¢: number) {
  const äº¤æ˜“é‡‘é¢ = è‚¡æ•° * äº¤æ˜“ä»·;
  const ä»“ä½ = (äº¤æ˜“é‡‘é¢ / æ€»é‡‘é¢) * 100;
  return { äº¤æ˜“é‡‘é¢, ä»“ä½ };
}
```

#### å½“ä¿®æ”¹ä»“ä½æ—¶ï¼š
```typescript
function updateOnPositionChange(ä»“ä½: number, æ€»é‡‘é¢: number, äº¤æ˜“ä»·: number) {
  const äº¤æ˜“é‡‘é¢ = (ä»“ä½ / 100) * æ€»é‡‘é¢;
  const è‚¡æ•° = Math.floor(äº¤æ˜“é‡‘é¢ / äº¤æ˜“ä»·);
  return { äº¤æ˜“é‡‘é¢, è‚¡æ•° };
}
```

#### å½“ä¿®æ”¹äº¤æ˜“é‡‘é¢æ—¶ï¼š
```typescript
function updateOnAmountChange(äº¤æ˜“é‡‘é¢: number, äº¤æ˜“ä»·: number, æ€»é‡‘é¢: number) {
  const è‚¡æ•° = Math.floor(äº¤æ˜“é‡‘é¢ / äº¤æ˜“ä»·);
  const ä»“ä½ = (äº¤æ˜“é‡‘é¢ / æ€»é‡‘é¢) * 100;
  return { è‚¡æ•°, ä»“ä½ };
}
```

## å¼€å‘é˜¶æ®µ

### é˜¶æ®µ1: åŸºç¡€æ¡†æ¶ (1-2å¤©)
1. åˆ›å»º Next.js é¡¹ç›®
2. é…ç½® TailwindCSS + shadcn/ui
3. è®¾ç½® SQLite + Better-SQLite3
4. åˆ›å»ºæ•°æ®åº“Schemaå’Œåˆå§‹åŒ–è„šæœ¬
5. å®ç°è®¡ç®—é€»è¾‘å‡½æ•° (lib/calculations.ts)

### é˜¶æ®µ2: æ ¸å¿ƒAPI (2-3å¤©)
1. é¡¹ç›®ç®¡ç† API (CRUD)
2. äº¤æ˜“ç®¡ç† API (CRUD)
3. è®¡åˆ’é¡µé¢ API (è·å–è¿›è¡Œä¸­çš„äº¤æ˜“)
4. æ€»è§ˆç»Ÿè®¡ API
5. æµ‹è¯•APIé¡µé¢ï¼ˆæµ‹è¯•æ‰€æœ‰apiï¼Œå·¦ä¾§æ˜¯æ‰€æœ‰apiçš„æŒ‰é’®å’Œæ‰€æœ‰èƒ½å¤Ÿä¿®æ”¹çš„é¡¹çš„è¾“å…¥æ¡†ã€‚å³ä¾§æ˜¯apiè¿”å›ç»“æœæ˜¾ç¤ºï¼‰

### é˜¶æ®µ3: å‰ç«¯é¡µé¢ (4-5å¤©)
1. **å¯ç¼–è¾‘ç»„ä»¶å¼€å‘** (1å¤©)
   - InlineEditText: æ–‡æœ¬ç¼–è¾‘ç»„ä»¶
   - InlineEditNumber: æ•°å­—ç¼–è¾‘ç»„ä»¶  
   - InlineEditSelect: é€‰æ‹©ç¼–è¾‘ç»„ä»¶
   - å®æ—¶è®¡ç®—é’©å­å‡½æ•°

2. **è®¡åˆ’é¡µé¢** (1å¤©)
   - é¡¹ç›®åˆ†ç»„æ˜¾ç¤ºç»„ä»¶
   - äº¤æ˜“è¡Œç»„ä»¶ï¼ˆå¯ç¼–è¾‘ï¼‰
   - å®æ—¶è®¡ç®—é›†æˆ

3. **é¡¹ç›®é¡µé¢** (1å¤©)
   - é¡¹ç›®ä¿¡æ¯å±•ç¤ºç»„ä»¶ï¼ˆå¯ç¼–è¾‘ï¼‰
   - äº¤æ˜“åˆ—è¡¨ç»„ä»¶ï¼ˆæŒ‰çŠ¶æ€åˆ†ç»„ï¼‰
   - é¡¹ç›®-äº¤æ˜“å…³è”é€»è¾‘

4. **æ€»è§ˆé¡µé¢** (1å¤©)
   - ç»Ÿè®¡å¡ç‰‡ç»„ä»¶
   - åŸºç¡€å›¾è¡¨é›†æˆ
   - æ•°æ®åˆ·æ–°æœºåˆ¶

5. **å¯¼èˆªå’Œå¸ƒå±€** (1å¤©)
   - é¡µé¢å¯¼èˆªç»„ä»¶
   - å“åº”å¼å¸ƒå±€è°ƒæ•´
   - æ ·å¼ç»Ÿä¸€åŒ–

### é˜¶æ®µ4: å®Œå–„å’Œéƒ¨ç½² (1-2å¤©)
1. æ•°æ®éªŒè¯å’Œé”™è¯¯å¤„ç†
2. åŠ è½½çŠ¶æ€å’Œç”¨æˆ·åé¦ˆ
3. å“åº”å¼è®¾è®¡ä¼˜åŒ–
4. Vercel éƒ¨ç½²é…ç½®
5. æ•°æ®å¤‡ä»½æ–¹æ¡ˆ

## å…³é”®æŠ€æœ¯ç‚¹

### 1. SQLite åœ¨ Vercel çš„å¤„ç†
```typescript
// lib/db.ts
import Database from 'better-sqlite3';
import path from 'path';

let db: Database.Database | null = null;

export function getDatabase() {
  if (!db) {
    const dbPath = path.join(process.cwd(), 'data', 'investment.db');
    db = new Database(dbPath);
    initializeDatabase(db);
  }
  return db;
}
```

### 2. å®æ—¶è®¡ç®—é’©å­
```typescript
// hooks/useTransactionCalculations.ts
export function useTransactionCalculations(project: Project) {
  const [transaction, setTransaction] = useState<Transaction>();
  
  const updateField = (field: string, value: any) => {
    const updated = { ...transaction };
    
    switch (field) {
      case 'è­¦å‘Šæ–¹å‘':
        updated.è·ç¦» = calculateDistance(updated.äº¤æ˜“ä»·, project.å½“å‰ä»·, value);
        break;
      case 'è·ç¦»':
        updated.äº¤æ˜“ä»· = calculatePriceFromDistance(value, project.å½“å‰ä»·, updated.è­¦å‘Šæ–¹å‘);
        break;
      // ... å…¶ä»–è®¡ç®—é€»è¾‘
    }
    
    setTransaction(updated);
  };
  
  return { transaction, updateField };
}
```

### 3. å¯ç¼–è¾‘ç»„ä»¶è®¾è®¡
```typescript
// components/editable/InlineEditNumber.tsx
interface InlineEditNumberProps {
  value: number;
  onChange: (value: number) => void;
  onBlur?: () => void;
  precision?: number;
  suffix?: string;
}

export function InlineEditNumber({ value, onChange, onBlur, precision = 2, suffix }: InlineEditNumberProps) {
  const [editing, setEditing] = useState(false);
  const [tempValue, setTempValue] = useState(value.toString());
  
  // å®ç°ç¼–è¾‘é€»è¾‘...
}
```

## éƒ¨ç½²æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡**: æœ€å°åŒ–é…ç½®ï¼Œä¸»è¦æ˜¯æ•°æ®åº“è·¯å¾„
2. **æ„å»ºä¼˜åŒ–**: ç¡®ä¿SQLiteæ–‡ä»¶æ­£ç¡®æ‰“åŒ…
3. **Edge Runtime**: åˆ©ç”¨Vercel EdgeåŠŸèƒ½æå‡æ€§èƒ½
4. **å¤‡ä»½ç­–ç•¥**: å®šæœŸå¯¼å‡ºæ•°æ®åˆ°JSONæˆ–CSV

## ç»´æŠ¤å»ºè®®

1. **ä»£ç ç»„ç»‡**: æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†ï¼Œå•ä¸€èŒè´£
2. **ç±»å‹å®‰å…¨**: ä½¿ç”¨TypeScriptä¸¥æ ¼æ¨¡å¼
3. **é”™è¯¯å¤„ç†**: APIç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼
4. **æ•°æ®éªŒè¯**: ä½¿ç”¨Zodè¿›è¡Œè¾“å…¥éªŒè¯
5. **æµ‹è¯•**: é‡ç‚¹æµ‹è¯•è®¡ç®—é€»è¾‘æ­£ç¡®æ€§

## å­¦ä¹ æˆæœ¬è¯„ä¼°

* **æ–°æ‰‹å‹å¥½**: Next.js + SQLite å­¦ä¹ æ›²çº¿å¹³ç¼“
* **æ–‡æ¡£ä¸°å¯Œ**: æ‰€é€‰æŠ€æœ¯æ ˆæ–‡æ¡£å®Œå–„
* **è°ƒè¯•ç®€å•**: SQLite å¯ç›´æ¥æŸ¥çœ‹ï¼Œä¾¿äºè°ƒè¯•
* **éƒ¨ç½²ç®€å•**: Vercel ä¸€é”®éƒ¨ç½²