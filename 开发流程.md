好 👌 既然确定用 **MongoDB Atlas + Vercel + Next.js**，我给你更新一份针对这个组合的 **轻量级开发计划**，专门为个人使用优化，保证易开发、易维护。

---

# 🚀 更新后的开发计划（基于 MongoDB Atlas）

## 1. 项目架构

```
/project-root
 ├── /app or /pages          # Next.js 前端页面
 │    ├── /api               # Next.js API Routes（后端接口）
 │    ├── dashboard          # 总览 Dashboard 页面
 │    ├── projects           # 项目管理页面
 │    ├── transactions       # 交易管理页面
 │    ├── funds              # 基金管理页面
 │    └── statistics         # 统计分析页面
 ├── /lib
 │    ├── db.ts              # MongoDB 连接配置
 │    └── models/            # Mongoose 数据模型
 ├── /components             # React UI 组件
 ├── /utils                  # 工具函数（盈亏计算、仓位计算等）
 ├── .env.local              # 环境变量 (MONGO_URI)
 └── package.json
```

---

## 2. 技术选型

* **前端 + API**: Next.js (Vercel 原生支持)
* **数据库**: MongoDB Atlas (云端托管)
* **ODM**: Mongoose (Schema/Model 管理)
* **UI**: TailwindCSS + shadcn/ui
* **图表**: Recharts
* **数据管理**: React Query（前端调用 API）

---

## 3. 开发步骤

### 阶段 1：基础环境

1. 创建 Next.js 项目 (`npx create-next-app`)
2. 安装依赖：`mongoose`、`@tanstack/react-query`、`tailwindcss`、`recharts`
3. 配置 MongoDB Atlas → 拿到 `MONGO_URI` → 写入 `.env.local`
4. 新建 `/lib/db.ts`：封装数据库连接逻辑（避免重复连接）

---

### 阶段 2：数据模型

在 `/lib/models/` 里用 Mongoose 定义 schema：

* `Project.ts`
* `Transaction.ts`
* `Fund.ts`
* `Statistics.ts`
* `Overview.ts`

👉 完全复用你给的 MongoDB 数据结构。

---

### 阶段 3：API Routes

* **项目 (Project)**

  * `POST /api/projects` 新增
  * `GET /api/projects` 列表
  * `GET /api/projects/[id]` 单个详情
  * `PUT /api/projects/[id]` 更新
  * `DELETE /api/projects/[id]` 删除

* **交易 (Transaction)**

  * `POST /api/transactions` 新增
  * `GET /api/transactions?projectId=xxx` 查询
  * `PUT /api/transactions/[id]` 更新状态

* **基金 (Fund)**

  * `POST /api/funds` 新增基金
  * `POST /api/funds/[id]/trades` 添加交易
  * `GET /api/funds/[id]` 查看基金详情

* **统计 (Statistics)**

  * `GET /api/statistics/monthly/[yearMonth]`
  * `GET /api/statistics/yearly/[year]`

* **总览 (Overview)**

  * `GET /api/overview` → 聚合所有数据，返回 Dashboard 所需字段

---

### 阶段 4：前端页面

1. **Dashboard**

   * 总投资金额、总盈亏金额、盈亏率卡片
   * 仓位饼图、盈亏趋势折线图

2. **项目管理**

   * 表格：项目名称 / 成本价 / 当前价 / 盈亏金额 / 仓位
   * 点击进入 → 查看交易详情

3. **交易管理**

   * 表单：买入/卖出、止盈止损设置
   * 状态流转（计划 → 完成）

4. **基金管理**

   * 基金列表
   * 基金净值曲线图
   * 交易记录表格

5. **统计分析**

   * 月度盈亏（柱状图）
   * 年度盈亏（折线图）
   * 自主投资 vs 基金投资对比

---

### 阶段 5：上线部署

1. 代码推送到 GitHub
2. Vercel 连接 GitHub 仓库，自动部署
3. 在 Vercel 设置环境变量 `MONGO_URI`（指向 MongoDB Atlas）
4. 部署完成后自动生成线上地址

---

## 4. 后续优化

* **自动行情更新**：用定时任务（cron）从行情 API 拉取数据，更新 `当前价`。
* **风险预警**：设置止盈/止损提醒（邮箱 / 微信推送）。
* **身份认证（可选）**：NextAuth.js → 仅自己登录可见。

---

⚡ 总结：

> 你的最终系统就是一个 **Next.js 应用（Vercel 部署） + MongoDB Atlas（云数据库）**，所有逻辑在 API Routes 里，前端通过 React Query 调用 API，结构简单清晰，个人维护成本最低。

---

要不要我帮你写一个 **`/lib/db.ts` + 一个最小 API 示例**（比如新增项目）？这样你直接复制到项目里，就能连 MongoDB Atlas 跑起来。
